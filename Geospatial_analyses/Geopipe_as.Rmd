---
title: "Simulations of Gaussion Random Fields"
author: "Soliman, Aiman S; Mainzer, Liudmila Sergeevna; Zhang Yazhuo; Priya "
date: "3/15/2019"
output: html_document
---
In the simulation, the first part is to simulate a grid (an image) of a random field with predefined parameters (auto-correlation range and density). The second step is to add geographic coordinates to the simulated grid so you could map it to a specific area of interest.

```{r echo=FALSE, include=FALSE}
#loading packages
if (!require("pacman")) install.packages("pacman")
pacman::p_load(
  "geoR",
  "raster",
  "rgdal"
)
```

1) Data is generated by GeoR pakage using grf() function, which generates simulations of Gaussion random fields for given covariance parameters.\s\s
In the Arguments, n stands for number of points(spatial locations) in each simulations.
cov.pars stands for covariance parameters and range parameter.

We tried to simulate the random field using different range values. 

```{r echo=TRUE, include=TRUE}
set.seed(2333)
for (i in seq(0.05, 0.95, by=0.05)) {
  cov_par = c(1, i)
  sim3 <- grf(40401, grid="reg", cov.pars=cov_par)
  image(sim3, main=format(c("Trying different value in cov par: ", i))
        , col=gray(seq(1, .1, l=30)))
}
```

Fow now, cov_pars=c(1, .2) is chosen.

```{r echo=TRUE, include=TRUE}
cov_pars=c(1, .2)
sim3 <- grf(40401, grid="reg", cov.pars=cov_pars) 

```

```{r echo=TRUE, include=TRUE}
image(sim3, main="Geospatial Simulation", col=gray(seq(1, .1, l=30)))

```


2) Add geographic coordinates to the simulated grid so you could map it to a specific area of interest (e.g., Chicago or Urbana, etc.)\s\s

1.export your simulated grid in an image format .tif or just assign it to a variable if you would like to build a single pipeline (e.g. no intermediate steps are saved)

2. identify the area that you would like to project your simulation on. You will need to define the min & max lat and long for the city bounding box.
https://search.earthdata.nasa.gov/search

3. define a geographic projection; we will select the simplest one, which is geographic lat long (wgs84)

4. run the code as in the blog; you will need two r packages rgdal and raster
http://robertmyles.github.io/2016/08/13/geo-reference-an-image-in-r/ 

5. export your geo-referenced simulation image as geotif

In the case, min-max coordinates for  

Chicago
41.4755859375,-88.154296875
41.99853515625,-87.64892578125
```{r pressure, echo=TRUE}
Map <- raster(sim3)   #Create a raster object
xmin(Map) <- -88.154296875   #assign lat and long of Chicago to coordinates
xmax(Map) <- -87.64892578125
ymin(Map) <- 41.4755859375
ymax(Map) <- 41.99853515625
crs(Map) <-'+init=epsg:4326'
plot(Map)
#Export geo-referenced simulation image as geotif
writeRaster(Map, "Gmap1.tiff", "GTiff" , overwrite=TRUE)
```

References:\s\s

 RIBEIRO Jr., P.J. & DIGGLE, P.J. (2001) geoR: A package for
 geostatistical analysis. R-NEWS, Vol 1, No 2, 15-18. ISSN 1609-3631.
 
 Robert M.M.(2016) Geo-Reference an image in R. Retrieved from http://robertmyles.github.io/2016/08/13/geo-reference-an-image-in-r/
